function [x6,y6]=edges6(Modlp,X,Y)%	Custom function for finding the x,y coordinates of the edges%	of where the model media values change.%   X and Y are the values of the x and y coordinates along the axes%       of the model. (These vectors must be offset by Dx/2, etc. to%       put line at edge of pixel when imagesc is used).%	Used by HASgui5. Copyright 2011 D.A. Christensen.%   Changes:%       2/3/11 - Modified edgesmall to use intire image since imagesc%           is used in HASgui5 rather than pcolor.%       1/21/13 - Changed xl, yl matrices into vectors so the edge lines%           can be plotted by 'line' commands MUCH quicker. Needed to intersperse NaNs%       	between each two points so the edge lines don't connect.  Changed%           function name to edges6.%%   Copyright D.A. Christensen 2013%   Jan. 21, 2013DH=(X(2)-X(1))/2; DV=(Y(2)-Y(1))/2;  % find half increments (in axes units) of axes.Mh1=[ones(size(Modlp,1),1),Modlp(:,1:end-1)]; % shift to right by one. % Mh1=circshift(Modlp,[0,1]);Dh=Modlp-Mh1;indh=find(Dh~=0);[yh,xh]=ind2sub(size(Mh1),indh);yh1=Y(yh)+DV; yh=Y(yh)-DV; xh=X(xh)-DH; % convert to units of axis.Mv1=[ones(1,size(Modlp,2));Modlp(1:end-1,:)]; % shift down by one.% Mv1=circshift(Modlp,[1,0]);Dv=Modlp-Mv1;indv=find(Dv~=0);[yv,xv]=ind2sub(size(Mv1),indv);yv=Y(yv)-DV; xv1=X(xv)+DH; xv=X(xv)-DH;   % again, convert to units of axis.xl=[xh,xv1;xh,xv]; yl=[yh1,yv;yh,yv];  % original matrices used in edges5.NaNline=NaN*ones(1,length(xl)); % NaNs for interspersing.xl=[xl;NaNline]; yl=[yl;NaNline]; % temporarily 3-row matrices.x6=reshape(xl,1,[]); y6=reshape(yl,1,[]);   % now vectors, so 'line' will plot much faster.